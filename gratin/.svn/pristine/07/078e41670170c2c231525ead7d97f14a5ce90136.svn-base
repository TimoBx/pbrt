<gratin file="customNode">
 <string val="imgFlowLines" name="customHandleName"/>
 <string val="visualization/flow/" name="customHandlePath"/>
 <string val="Flow visualization using lines" name="customHandleDesc"/>
 <string val="Show an input flow using simple colored lines.&lt;br>&#xa;&lt;br>&#xa;&quot;size&quot; controls the length of each line.&lt;br>&#xa;&quot;origFlow&quot; allows to show the original input flow.&lt;br>&#xa;&quot;orthoFlow&quot; allows to show the orthogonal flow.&lt;br>" name="customHandleHelp"/>
 <int val="1" name="customHandleInputDescSize"/>
 <int val="1" name="customHandleOutputDescSize"/>
 <string val="flow" name="customHandleInputDesc-0"/>
 <string val="flowVis" name="customHandleOutputDesc-0"/>
 <string val="imgGeneric" name="origHandleName"/>
 <string val="generic/" name="origHandlePath"/>
 <string val="Generic node for image processing" name="origHandleDesc"/>
 <string val="This node was designed to create custom shaders&#xa;The settings widget allows to modify input, output parameters&#xa;as well as the output image sizes.&#xa;&#xa;WARNING1: you will be able to modify the number of inputs/outputs&#xa;only if the node is entirely disconnected.&#xa;WARNING2: input/output names will not be modified if a custom node is created&#xa;from this node beacause these names should be edited directly in the setting widget&#xa;WARNING3: modifying the settings of a node will remove all previously&#xa;defined keyframes&#xa;&#xa;* Special data allows to modify the output image (using a multiple of&#xa;the input size, plus an offset vector&#xa;Check use mouse if you want to interact with the mouse&#xa;&#xa;* Input data allows to add/remove/displace input data (only if disconnected)&#xa;&#xa;* Output data allows to add/remove/displace output data (only if disconnected)&#xa;&#xa;* Param data allows to add/remove parameters that will automatically be &#xa;included in your shader.&#xa;For each of them you may choose a proper name, type, and min/max/default values.&#xa;Check keyframes if you want your parameter to be accessible&#xa; through the animation widget&#xa;&#xa;In the node interface itself:&#xa;Source tab contains the head and body of your GLSL source (only the body is editable)&#xa;Params tab contains the defined widgets according to your setting choices&#xa;Log tab contains compilation errors&#xa;&#xa;Once your settings and source completed, click on apply to see the result&#xa;" name="origHandleHelp"/>
 <int val="1" name="origHandleInputDescSize"/>
 <int val="1" name="origHandleOutputDescSize"/>
 <string val="flow" name="origHandleInputDesc-0"/>
 <string val="flowVis" name="origHandleOutputDesc-0"/>
 <string val="imgGeneric" name="nodeName-0"/>
 <string val="generic/" name="nodePath-0"/>
 <uint val="5" name="nodeId-0"/>
 <uint val="1" name="nodeGraphId-0"/>
 <uint val="1" name="nbInputs-0"/>
 <uint val="1" name="nbOutputs-0"/>
 <vector2f name="nodePos-0">
  <float val="1535.12" name="0"/>
  <float val="-1506.16" name="1"/>
 </vector2f>
 <bool val="0" name="nodeGrouped-0"/>
 <bool val="1" name="nodeHasWidget-0"/>
 <IOData name="node-0">
  <string val="flow" name="genericIName-0"/>
  <string val="flowVis" name="genericOName-0"/>
  <vector2f name="genericTSize">
   <float val="1" name="0"/>
   <float val="1" name="1"/>
  </vector2f>
  <vector2f name="genericTOffset">
   <float val="0" name="0"/>
   <float val="0" name="1"/>
  </vector2f>
  <bool val="0" name="genericNeedMouse"/>
  <uint val="1" name="genericNbSliderFloat"/>
  <bool val="1" name="genericSliderFloatIsKF-0"/>
  <string val="size" name="genericSliderFloatName-0"/>
  <uint val="2" name="genericNbSliderInt"/>
  <bool val="1" name="genericSliderIntIsKF-0"/>
  <string val="origFlow" name="genericSliderIntName-0"/>
  <bool val="1" name="genericSliderIntIsKF-1"/>
  <string val="orthoFlow" name="genericSliderIntName-1"/>
  <string val="#version 330&#xa;&#xa;in vec2 texcoord;&#xa;&#xa;layout(location = 0) out vec4 flowVis;&#xa;uniform sampler2D flow;&#xa;uniform float size;&#xa;uniform int origFlow;&#xa;uniform int orthoFlow;&#xa;" name="genericHead"/>
  <string val="vec2 S = 1.0/vec2(textureSize(flow,0));&#xa;&#xa;vec2 squareCoord() {&#xa;  return (mod(gl_FragCoord.xy,size)-vec2(0.5*size))*S;&#xa;}&#xa;&#xa;float radius() {&#xa;  return 0.45*size*S;&#xa;}&#xa;&#xa;vec2 center(in vec2 p) {&#xa;  return texcoord-p;&#xa;}&#xa;&#xa;vec2 getDir(in vec2 c) {&#xa;  vec2 d = texture2D(flow,c).xy;&#xa;  return d==vec2(0.0) ? vec2(0.0) : normalize(d);&#xa;}&#xa;&#xa;vec4 draw(in vec2 p,in float r,in vec3 col) {&#xa;  vec4 back  = vec4(1.0);&#xa;  vec4 front = vec4(col,1.0);&#xa;  &#xa;  if(abs(p.x)>r)&#xa;    return back;&#xa;  &#xa;  float s =  smoothstep(0.0,0.75*(S.x+S.y),abs(p.y));&#xa;&#xa;  return mix(front,back,s);&#xa;}&#xa;&#xa;vec2 rotate(in vec2 c,in vec2 t,in float r) {&#xa;  // rotation r with t = center of rotation&#xa;  float cr = cos(r);&#xa;  float sr = sin(r);&#xa;&#xa;  mat3 T1 = mat3(1.0f,0.0f,0.0f,&#xa;&#x9;&#x9; 0.0f,1.0f,0.0f,&#xa;&#x9;&#x9; -t.x,-t.y,1.0f);&#xa;&#xa;  mat3 T2 = mat3(1.0f,0.0f,0.0f,&#xa;&#x9;&#x9; 0.0f,1.0f,0.0f,&#xa;&#x9;&#x9; t.x,t.y,1.0f);&#xa;&#xa;  mat3 R = mat3(cr,-sr,0.0f,&#xa;&#x9;&#x9;sr,cr,0.0f,&#xa;&#x9;&#x9;0.0f,0.0f,1.0f);&#xa;&#xa;  return (T2*R*T1*vec3(c,1.0f)).xy;&#xa;}&#xa;&#xa;void main(void) {&#xa;  const float piOn2 = 1.57079632679489661923;&#xa;&#xa;  vec2  p = squareCoord();&#xa;  float r = radius();&#xa;  vec2  c = center(p);&#xa;  vec2  d = getDir(c);&#xa;  &#xa;  float teta = d.y>=0.0 ? acos(d.x) : -acos(d.x);&#xa;  &#xa;  vec2 pt1 = rotate(p,vec2(0.0),teta);&#xa;  vec2 pt2 = rotate(p,vec2(0.0),teta+piOn2);&#xa;  &#xa;  vec4 t1 = origFlow==1 ? draw(pt1,r,vec3(0.0,0.0,1.0)) : vec4(1.0);&#xa;  vec4 t2 = orthoFlow==1 ? draw(pt2,r,vec3(1.0,0.0,0.0)) : vec4(1.0);&#xa;&#xa;  flowVis = min(t1,t2);&#xa;  &#xa;  if(d==vec2(0.0))&#xa;    flowVis = vec4(1.0);&#xa;}&#xa;" name="genericBody"/>
 </IOData>
 <IOData name="nodeWidget-0">
  <uint val="3" name="nbChildren"/>
  <IOData name="childWidget-0">
   <IOData name="keyframedFloat">
    <float val="5" name="minVal"/>
    <float val="100" name="maxVal"/>
    <float val="10" name="currentVal"/>
    <IOData name="curve">
     <int val="0" name="interpType"/>
     <int val="0" name="leftType"/>
     <int val="0" name="rightType"/>
     <IOData name="interpolator">
      <uint val="1" name="nbPoints"/>
      <uint val="0" name="nbTangents"/>
      <vector2f name="controlPoint-0">
       <float val="0" name="0"/>
       <float val="10" name="1"/>
      </vector2f>
     </IOData>
    </IOData>
   </IOData>
   <float val="10" name="sliderVal"/>
   <float val="5" name="sliderMinVal"/>
   <float val="100" name="sliderMaxVal"/>
   <uint val="0" name="nbChildren"/>
  </IOData>
  <IOData name="childWidget-1">
   <IOData name="keyframedFloat">
    <float val="0" name="minVal"/>
    <float val="1" name="maxVal"/>
    <float val="1" name="currentVal"/>
    <IOData name="curve">
     <int val="0" name="interpType"/>
     <int val="0" name="leftType"/>
     <int val="0" name="rightType"/>
     <IOData name="interpolator">
      <uint val="1" name="nbPoints"/>
      <uint val="0" name="nbTangents"/>
      <vector2f name="controlPoint-0">
       <float val="0" name="0"/>
       <float val="1" name="1"/>
      </vector2f>
     </IOData>
    </IOData>
   </IOData>
   <int val="1" name="sliderVal"/>
   <int val="0" name="sliderMinVal"/>
   <int val="1" name="sliderMaxVal"/>
   <uint val="0" name="nbChildren"/>
  </IOData>
  <IOData name="childWidget-2">
   <IOData name="keyframedFloat">
    <float val="0" name="minVal"/>
    <float val="1" name="maxVal"/>
    <float val="0" name="currentVal"/>
    <IOData name="curve">
     <int val="0" name="interpType"/>
     <int val="0" name="leftType"/>
     <int val="0" name="rightType"/>
     <IOData name="interpolator">
      <uint val="1" name="nbPoints"/>
      <uint val="0" name="nbTangents"/>
      <vector2f name="controlPoint-0">
       <float val="0" name="0"/>
       <float val="0" name="1"/>
      </vector2f>
     </IOData>
    </IOData>
   </IOData>
   <int val="0" name="sliderVal"/>
   <int val="0" name="sliderMinVal"/>
   <int val="1" name="sliderMaxVal"/>
   <uint val="0" name="nbChildren"/>
  </IOData>
 </IOData>
 <vector2f name="nodeInputPos-0-0">
  <float val="56.32" name="0"/>
  <float val="28.16" name="1"/>
 </vector2f>
 <vector2f name="nodeOutputPos-0-0">
  <float val="56.32" name="0"/>
  <float val="28.16" name="1"/>
 </vector2f>
</gratin>
